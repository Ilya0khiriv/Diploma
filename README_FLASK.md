# README

## Обзор
Этот проект представляет собой веб-приложение на основе Flask с функциями аутентификации пользователей, сохранения истории общения и получения ответов от ИИ. Для управления базой данных используется SQLAlchemy, а для работы с формами — Flask-WTF. Ответы ИИ поступают из внешнего сервиса, работающего по адресу `http://0.0.0.0:8998`.

### Основные возможности
- **Аутентификация пользователей**:
  - Регистрация и вход с хешированием паролей через `Flask-Bcrypt`.
  - Управление сессиями пользователей с помощью `Flask-Login`.

- **Общение с ИИ**:
  - Пользователи могут задавать вопросы системе ИИ и получать ответы.
  - Вопросы и ответы сохраняются в базе данных SQLite для отображения истории.
  - Настройка количества отображаемых сообщений из истории.

- **Интерфейс**:
  - Формы Flask-WTF для регистрации, входа, отправки вопросов и настройки памяти.
  - Шаблоны для отображения страниц (`login.html`, `register.html`, `base.html`).

---

## Описание файлов

### `main.py`
Основной файл приложения, который:
- Инициализирует Flask, SQLAlchemy и Flask-Login.
- Определяет модели базы данных (`User` и `Conversation`).
- Управляет аутентификацией пользователей (регистрация, вход, выход).
- Реализует функционал для отправки вопросов ИИ и просмотра истории общения.
- Отправляет запросы внешнему сервису для получения ответов через эндпоинт `/translate`.

**Ключевые компоненты**:
- **Модели**:
  - `User`: Хранит данные пользователей (логин, пароль, лимит памяти для сообщений).
  - `Conversation`: Хранит сообщения пользователя и ответы ИИ, привязанные к пользователю.

- **Маршруты**:
  - `/register`: Регистрация нового пользователя.
  - `/login`: Вход в систему.
  - `/`: Основная защищённая страница для общения с ИИ.
  - `/logout`: Выход из системы.

- **Вспомогательные функции**:
  - `append_conversation`: Добавляет сообщение в базу данных.
  - `get_response`: Отправляет запрос внешнему сервису ИИ и обрабатывает его ответ.

---

## Предварительные требования
- Python 3.8+
- SQLite (установлен по умолчанию с Python)
- Необходимые Python-библиотеки:
  - `Flask`
  - `Flask-SQLAlchemy`
  - `Flask-Bcrypt`
  - `Flask-Login`
  - `Flask-WTF`
  - `requests`

---

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone <repository-url>
   cd <repository-folder>
   ```

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

3. Инициализируйте базу данных:
   ```bash
   python main.py
   ```

---

## Использование

1. Запустите Flask-приложение:
   ```bash
   python main.py
   ```
   - Приложение будет доступно по адресу `http://127.0.0.1:9900`.

2. Зайдите в браузер:
   - Перейдите на страницу `http://127.0.0.1:9900/register`, чтобы создать аккаунт.
   - Выполните вход на `http://127.0.0.1:9900/login`.

3. Используйте главную страницу (`/`) для:
   - Отправки вопросов ИИ.
   - Настройки количества сообщений, отображаемых в истории.

4. Выйти из системы можно через маршрут `/logout`.

